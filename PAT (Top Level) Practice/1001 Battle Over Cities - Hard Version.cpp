/*
  @pintia psid=994805148990160896 pid=994805156657348608 compiler=GXX
  ProblemSet: PAT (Top Level) Practice
  Title: 1001 Battle Over Cities - Hard Version
  https://pintia.cn/problem-sets/994805148990160896/exam/problems/type/7?problemSetProblemId=994805156657348608
*/
// @pintia code=start

// @pintia code=end